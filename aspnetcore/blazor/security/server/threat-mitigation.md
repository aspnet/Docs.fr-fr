---
title: Guide d’atténuation des menaces pour ASP.NET Core Blazor Server
author: guardrex
description: Découvrez comment limiter les menaces de sécurité pour les Blazor Server applications.
monikerRange: '>= aspnetcore-3.1'
ms.author: riande
ms.custom: mvc
ms.date: 11/09/2020
no-loc:
- appsettings.json
- ASP.NET Core Identity
- cookie
- Cookie
- Blazor
- Blazor Server
- Blazor WebAssembly
- Identity
- Let's Encrypt
- Razor
- SignalR
uid: blazor/security/server/threat-mitigation
ms.openlocfilehash: 2a5add79d60ddcbb1afdb9489fa16da692a7d6bd
ms.sourcegitcommit: a1db01b4d3bd8c57d7a9c94ce122a6db68002d66
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 03/04/2021
ms.locfileid: "102109661"
---
# <a name="threat-mitigation-guidance-for-aspnet-core-blazor-server"></a><span data-ttu-id="ebe39-103">Guide d’atténuation des menaces pour ASP.NET Core Blazor Server</span><span class="sxs-lookup"><span data-stu-id="ebe39-103">Threat mitigation guidance for ASP.NET Core Blazor Server</span></span>

<span data-ttu-id="ebe39-104">Blazor Server les applications adoptent un modèle de traitement des données *avec état* , où le serveur et le client maintiennent une relation à long terme.</span><span class="sxs-lookup"><span data-stu-id="ebe39-104">Blazor Server apps adopt a *stateful* data processing model, where the server and client maintain a long-lived relationship.</span></span> <span data-ttu-id="ebe39-105">L’état persistant est géré par un [circuit](xref:blazor/state-management)qui peut s’étendre sur des connexions qui sont également potentiellement durables.</span><span class="sxs-lookup"><span data-stu-id="ebe39-105">The persistent state is maintained by a [circuit](xref:blazor/state-management), which can span connections that are also potentially long-lived.</span></span>

<span data-ttu-id="ebe39-106">Lorsqu’un utilisateur visite un Blazor Server site, le serveur crée un circuit dans la mémoire du serveur.</span><span class="sxs-lookup"><span data-stu-id="ebe39-106">When a user visits a Blazor Server site, the server creates a circuit in the server's memory.</span></span> <span data-ttu-id="ebe39-107">Le circuit indique au navigateur le contenu à afficher et répond aux événements, par exemple lorsque l’utilisateur sélectionne un bouton dans l’interface utilisateur.</span><span class="sxs-lookup"><span data-stu-id="ebe39-107">The circuit indicates to the browser what content to render and responds to events, such as when the user selects a button in the UI.</span></span> <span data-ttu-id="ebe39-108">Pour effectuer ces actions, un circuit appelle des fonctions JavaScript dans le navigateur de l’utilisateur et les méthodes .NET sur le serveur.</span><span class="sxs-lookup"><span data-stu-id="ebe39-108">To perform these actions, a circuit invokes JavaScript functions in the user's browser and .NET methods on the server.</span></span> <span data-ttu-id="ebe39-109">Cette interaction JavaScript bidirectionnelle est connue sous le terme d’interopérabilité [JavaScript (JS Interop)](xref:blazor/call-javascript-from-dotnet).</span><span class="sxs-lookup"><span data-stu-id="ebe39-109">This two-way JavaScript-based interaction is referred to as [JavaScript interop (JS interop)](xref:blazor/call-javascript-from-dotnet).</span></span>

<span data-ttu-id="ebe39-110">Étant donné que l’interopérabilité de JS a lieu sur Internet et que le client utilise un navigateur distant, les Blazor Server applications partagent la plupart des problèmes de sécurité des applications Web.</span><span class="sxs-lookup"><span data-stu-id="ebe39-110">Because JS interop occurs over the Internet and the client uses a remote browser, Blazor Server apps share most web app security concerns.</span></span> <span data-ttu-id="ebe39-111">Cette rubrique décrit les menaces courantes pour les Blazor Server applications et fournit des conseils sur l’atténuation des menaces axées sur les applications accessibles sur Internet.</span><span class="sxs-lookup"><span data-stu-id="ebe39-111">This topic describes common threats to Blazor Server apps and provides threat mitigation guidance focused on Internet-facing apps.</span></span>

<span data-ttu-id="ebe39-112">Dans les environnements restreints, tels que les réseaux d’entreprise ou les intranets, quelques conseils d’atténuation :</span><span class="sxs-lookup"><span data-stu-id="ebe39-112">In constrained environments, such as inside corporate networks or intranets, some of the mitigation guidance either:</span></span>

* <span data-ttu-id="ebe39-113">Ne s’applique pas à l’environnement restreint.</span><span class="sxs-lookup"><span data-stu-id="ebe39-113">Doesn't apply in the constrained environment.</span></span>
* <span data-ttu-id="ebe39-114">Ne justifie pas le coût de l’implémentation, car le risque de sécurité est faible dans un environnement limité.</span><span class="sxs-lookup"><span data-stu-id="ebe39-114">Isn't worth the cost to implement because the security risk is low in a constrained environment.</span></span>

## <a name="blazor-and-shared-state"></a><span data-ttu-id="ebe39-115">Blazor et état partagé</span><span class="sxs-lookup"><span data-stu-id="ebe39-115">Blazor and shared state</span></span>

[!INCLUDE[](~/blazor/includes/security/blazor-shared-state.md)]

## <a name="resource-exhaustion"></a><span data-ttu-id="ebe39-116">Épuisement des ressources</span><span class="sxs-lookup"><span data-stu-id="ebe39-116">Resource exhaustion</span></span>

<span data-ttu-id="ebe39-117">L’épuisement des ressources peut se produire lorsqu’un client interagit avec le serveur et oblige le serveur à consommer trop de ressources.</span><span class="sxs-lookup"><span data-stu-id="ebe39-117">Resource exhaustion can occur when a client interacts with the server and causes the server to consume excessive resources.</span></span> <span data-ttu-id="ebe39-118">Une consommation excessive des ressources affecte principalement :</span><span class="sxs-lookup"><span data-stu-id="ebe39-118">Excessive resource consumption primarily affects:</span></span>

* [<span data-ttu-id="ebe39-119">UC</span><span class="sxs-lookup"><span data-stu-id="ebe39-119">CPU</span></span>](#cpu)
* [<span data-ttu-id="ebe39-120">Mémoire</span><span class="sxs-lookup"><span data-stu-id="ebe39-120">Memory</span></span>](#memory)
* [<span data-ttu-id="ebe39-121">Connexions client</span><span class="sxs-lookup"><span data-stu-id="ebe39-121">Client connections</span></span>](#client-connections)

<span data-ttu-id="ebe39-122">Les attaques par déni de service (DoS) cherchent généralement à épuiser les ressources d’une application ou d’un serveur.</span><span class="sxs-lookup"><span data-stu-id="ebe39-122">Denial of service (DoS) attacks usually seek to exhaust an app or server's resources.</span></span> <span data-ttu-id="ebe39-123">Toutefois, l’épuisement des ressources n’est pas nécessairement le résultat d’une attaque sur le système.</span><span class="sxs-lookup"><span data-stu-id="ebe39-123">However, resource exhaustion isn't necessarily the result of an attack on the system.</span></span> <span data-ttu-id="ebe39-124">Par exemple, les ressources limitées peuvent être épuisées en raison d’une demande élevée de l’utilisateur.</span><span class="sxs-lookup"><span data-stu-id="ebe39-124">For example, finite resources can be exhausted due to high user demand.</span></span> <span data-ttu-id="ebe39-125">DoS est abordé plus en détail dans la section [attaques par déni de service (dos)](#denial-of-service-dos-attacks) .</span><span class="sxs-lookup"><span data-stu-id="ebe39-125">DoS is covered further in the [Denial of service (DoS) attacks](#denial-of-service-dos-attacks) section.</span></span>

<span data-ttu-id="ebe39-126">Les ressources externes à l' Blazor infrastructure, telles que les bases de données et les handles de fichiers (utilisées pour lire et écrire des fichiers), peuvent également rencontrer une insuffisance des ressources.</span><span class="sxs-lookup"><span data-stu-id="ebe39-126">Resources external to the Blazor framework, such as databases and file handles (used to read and write files), may also experience resource exhaustion.</span></span> <span data-ttu-id="ebe39-127">Pour plus d’informations, consultez <xref:performance/performance-best-practices>.</span><span class="sxs-lookup"><span data-stu-id="ebe39-127">For more information, see <xref:performance/performance-best-practices>.</span></span>

### <a name="cpu"></a><span data-ttu-id="ebe39-128">UC</span><span class="sxs-lookup"><span data-stu-id="ebe39-128">CPU</span></span>

<span data-ttu-id="ebe39-129">L’épuisement du processeur peut se produire lorsqu’un ou plusieurs clients forcent le serveur à effectuer des tâches intensives du processeur.</span><span class="sxs-lookup"><span data-stu-id="ebe39-129">CPU exhaustion can occur when one or more clients force the server to perform intensive CPU work.</span></span>

<span data-ttu-id="ebe39-130">Par exemple, considérez une Blazor Server application qui calcule un *numéro Fibonnacci*.</span><span class="sxs-lookup"><span data-stu-id="ebe39-130">For example, consider a Blazor Server app that calculates a *Fibonnacci number*.</span></span> <span data-ttu-id="ebe39-131">Un numéro Fibonnacci est généré à partir d’une séquence Fibonnacci, où chaque nombre de la séquence est la somme des deux nombres précédents.</span><span class="sxs-lookup"><span data-stu-id="ebe39-131">A Fibonnacci number is produced from a Fibonnacci sequence, where each number in the sequence is the sum of the two preceding numbers.</span></span> <span data-ttu-id="ebe39-132">La quantité de travail nécessaire pour atteindre la réponse dépend de la longueur de la séquence et de la taille de la valeur initiale.</span><span class="sxs-lookup"><span data-stu-id="ebe39-132">The amount of work required to reach the answer depends on the length of the sequence and the size of the initial value.</span></span> <span data-ttu-id="ebe39-133">Si l’application ne place pas de limites sur la demande d’un client, les calculs gourmands en ressources processeur peuvent dominer le temps de l’UC et réduire les performances des autres tâches.</span><span class="sxs-lookup"><span data-stu-id="ebe39-133">If the app doesn't place limits on a client's request, the CPU-intensive calculations may dominate the CPU's time and diminish the performance of other tasks.</span></span> <span data-ttu-id="ebe39-134">Une consommation excessive des ressources est un problème de sécurité qui a un impact sur la disponibilité.</span><span class="sxs-lookup"><span data-stu-id="ebe39-134">Excessive resource consumption is a security concern impacting availability.</span></span>

<span data-ttu-id="ebe39-135">L’épuisement de l’UC est un problème pour toutes les applications accessibles au public.</span><span class="sxs-lookup"><span data-stu-id="ebe39-135">CPU exhaustion is a concern for all public-facing apps.</span></span> <span data-ttu-id="ebe39-136">Dans les applications Web standard, les demandes et les connexions expirent comme protection, mais Blazor Server les applications ne fournissent pas les mêmes protections.</span><span class="sxs-lookup"><span data-stu-id="ebe39-136">In regular web apps, requests and connections time out as a safeguard, but Blazor Server apps don't provide the same safeguards.</span></span> <span data-ttu-id="ebe39-137">Blazor Server les applications doivent inclure les vérifications et les limites appropriées avant d’effectuer des tâches potentiellement gourmandes en ressources processeur.</span><span class="sxs-lookup"><span data-stu-id="ebe39-137">Blazor Server apps must include appropriate checks and limits before performing potentially CPU-intensive work.</span></span>

### <a name="memory"></a><span data-ttu-id="ebe39-138">Mémoire</span><span class="sxs-lookup"><span data-stu-id="ebe39-138">Memory</span></span>

<span data-ttu-id="ebe39-139">L’épuisement de la mémoire peut se produire lorsqu’un ou plusieurs clients forcent le serveur à consommer une grande quantité de mémoire.</span><span class="sxs-lookup"><span data-stu-id="ebe39-139">Memory exhaustion can occur when one or more clients force the server to consume a large amount of memory.</span></span>

<span data-ttu-id="ebe39-140">Par exemple, considérez une Blazor application côté serveur avec un composant qui accepte et affiche une liste d’éléments.</span><span class="sxs-lookup"><span data-stu-id="ebe39-140">For example, consider a Blazor-server side app with a component that accepts and displays a list of items.</span></span> <span data-ttu-id="ebe39-141">Si l' Blazor application ne place pas de limites sur le nombre d’éléments autorisés ou le nombre d’éléments rendus au client, le traitement et le rendu gourmands en mémoire peuvent dominer la mémoire du serveur jusqu’au point où les performances du serveur sont affectées.</span><span class="sxs-lookup"><span data-stu-id="ebe39-141">If the Blazor app doesn't place limits on the number of items allowed or the number of items rendered back to the client, the memory-intensive processing and rendering may dominate the server's memory to the point where performance of the server suffers.</span></span> <span data-ttu-id="ebe39-142">Le serveur peut se bloquer ou ralentir le point d’arrêt.</span><span class="sxs-lookup"><span data-stu-id="ebe39-142">The server may crash or slow to the point that it appears to have crashed.</span></span>

<span data-ttu-id="ebe39-143">Tenez compte du scénario suivant pour gérer et afficher une liste d’éléments qui se rapportent à un scénario potentiel d’épuisement de mémoire sur le serveur :</span><span class="sxs-lookup"><span data-stu-id="ebe39-143">Consider the following scenario for maintaining and displaying a list of items that pertain to a potential memory exhaustion scenario on the server:</span></span>

* <span data-ttu-id="ebe39-144">Les éléments d’une `List<MyItem>` propriété ou d’un champ utilisent la mémoire du serveur.</span><span class="sxs-lookup"><span data-stu-id="ebe39-144">The items in a `List<MyItem>` property or field use the server's memory.</span></span> <span data-ttu-id="ebe39-145">Si l’application permet à la liste des éléments de croître sans limite, il y a un risque de manquer de mémoire sur le serveur.</span><span class="sxs-lookup"><span data-stu-id="ebe39-145">If the app allows the list of items to grow unbounded, there's a risk of the server running out of memory.</span></span> <span data-ttu-id="ebe39-146">Si la mémoire est insuffisante, la session en cours se termine (incident) et toutes les sessions simultanées de cette instance de serveur reçoivent une exception de mémoire insuffisante.</span><span class="sxs-lookup"><span data-stu-id="ebe39-146">Running out of memory causes the current session to end (crash) and all of the concurrent sessions in that server instance receive an out-of-memory exception.</span></span> <span data-ttu-id="ebe39-147">Pour éviter que ce scénario ne se produise, l’application doit utiliser une structure de données qui impose une limite d’éléments pour les utilisateurs simultanés.</span><span class="sxs-lookup"><span data-stu-id="ebe39-147">To prevent this scenario from occurring, the app must use a data structure that imposes an item limit on concurrent users.</span></span>
* <span data-ttu-id="ebe39-148">Si un schéma de pagination n’est pas utilisé pour le rendu, le serveur utilise de la mémoire supplémentaire pour les objets qui ne sont pas visibles dans l’interface utilisateur.</span><span class="sxs-lookup"><span data-stu-id="ebe39-148">If a paging scheme isn't used for rendering, the server uses additional memory for objects that aren't visible in the UI.</span></span> <span data-ttu-id="ebe39-149">Sans limite du nombre d’éléments, les demandes de mémoire peuvent épuiser la mémoire disponible du serveur.</span><span class="sxs-lookup"><span data-stu-id="ebe39-149">Without a limit on the number of items, memory demands may exhaust the available server memory.</span></span> <span data-ttu-id="ebe39-150">Pour éviter ce scénario, utilisez l’une des approches suivantes :</span><span class="sxs-lookup"><span data-stu-id="ebe39-150">To prevent this scenario, use one of the following approaches:</span></span>
  * <span data-ttu-id="ebe39-151">Utilisez des listes paginées lors du rendu.</span><span class="sxs-lookup"><span data-stu-id="ebe39-151">Use paginated lists when rendering.</span></span>
  * <span data-ttu-id="ebe39-152">Affiche uniquement les premiers 100 à 1 000 éléments et oblige l’utilisateur à entrer des critères de recherche pour rechercher des éléments au-delà des éléments affichés.</span><span class="sxs-lookup"><span data-stu-id="ebe39-152">Only display the first 100 to 1,000 items and require the user to enter search criteria to find items beyond the items displayed.</span></span>
  * <span data-ttu-id="ebe39-153">Pour un scénario de rendu plus avancé, implémentez des listes ou des grilles qui prennent en charge *la virtualisation*.</span><span class="sxs-lookup"><span data-stu-id="ebe39-153">For a more advanced rendering scenario, implement lists or grids that support *virtualization*.</span></span> <span data-ttu-id="ebe39-154">À l’aide de la virtualisation, les listes affichent uniquement un sous-ensemble d’éléments actuellement visibles par l’utilisateur.</span><span class="sxs-lookup"><span data-stu-id="ebe39-154">Using virtualization, lists only render a subset of items currently visible to the user.</span></span> <span data-ttu-id="ebe39-155">Lorsque l’utilisateur interagit avec la barre de défilement dans l’interface utilisateur, le composant affiche uniquement les éléments requis pour l’affichage.</span><span class="sxs-lookup"><span data-stu-id="ebe39-155">When the user interacts with the scrollbar in the UI, the component renders only those items required for display.</span></span> <span data-ttu-id="ebe39-156">Les éléments qui ne sont pas actuellement requis pour l’affichage peuvent être stockés dans le stockage secondaire, qui est l’approche idéale.</span><span class="sxs-lookup"><span data-stu-id="ebe39-156">The items that aren't currently required for display can be held in secondary storage, which is the ideal approach.</span></span> <span data-ttu-id="ebe39-157">Les éléments non affichés peuvent également être conservés en mémoire, ce qui est moins idéal.</span><span class="sxs-lookup"><span data-stu-id="ebe39-157">Undisplayed items can also be held in memory, which is less ideal.</span></span>

<span data-ttu-id="ebe39-158">Blazor Server les applications offrent un modèle de programmation similaire à d’autres infrastructures d’interface utilisateur pour les applications avec état, telles que WPF, Windows Forms ou Blazor WebAssembly .</span><span class="sxs-lookup"><span data-stu-id="ebe39-158">Blazor Server apps offer a similar programming model to other UI frameworks for stateful apps, such as WPF, Windows Forms, or Blazor WebAssembly.</span></span> <span data-ttu-id="ebe39-159">La principale différence réside dans le fait que dans plusieurs infrastructures d’interface utilisateur, la mémoire consommée par l’application appartient au client et affecte uniquement ce client individuel.</span><span class="sxs-lookup"><span data-stu-id="ebe39-159">The main difference is that in several of the UI frameworks the memory consumed by the app belongs to the client and only affects that individual client.</span></span> <span data-ttu-id="ebe39-160">Par exemple, une Blazor WebAssembly application s’exécute entièrement sur le client et utilise uniquement les ressources de mémoire du client.</span><span class="sxs-lookup"><span data-stu-id="ebe39-160">For example, a Blazor WebAssembly app runs entirely on the client and only uses client memory resources.</span></span> <span data-ttu-id="ebe39-161">Dans le Blazor Server scénario, la mémoire consommée par l’application appartient au serveur et est partagée entre les clients sur l’instance de serveur.</span><span class="sxs-lookup"><span data-stu-id="ebe39-161">In the Blazor Server scenario, the memory consumed by the app belongs to the server and is shared among clients on the server instance.</span></span>

<span data-ttu-id="ebe39-162">Les demandes de mémoire côté serveur sont un facteur à prendre en compte pour toutes les Blazor Server applications.</span><span class="sxs-lookup"><span data-stu-id="ebe39-162">Server-side memory demands are a consideration for all Blazor Server apps.</span></span> <span data-ttu-id="ebe39-163">Toutefois, la plupart des applications Web sont sans État et la mémoire utilisée lors du traitement d’une demande est libérée lorsque la réponse est retournée.</span><span class="sxs-lookup"><span data-stu-id="ebe39-163">However, most web apps are stateless, and the memory used while processing a request is released when the response is returned.</span></span> <span data-ttu-id="ebe39-164">Comme recommandation générale, n’autorisez pas les clients à allouer une quantité de mémoire non liée comme dans toute autre application côté serveur qui conserve les connexions clientes.</span><span class="sxs-lookup"><span data-stu-id="ebe39-164">As a general recommendation, don't permit clients to allocate an unbound amount of memory as in any other server-side app that persists client connections.</span></span> <span data-ttu-id="ebe39-165">La mémoire consommée par une Blazor Server application est conservée pendant une durée plus longue qu’une requête unique.</span><span class="sxs-lookup"><span data-stu-id="ebe39-165">The memory consumed by a Blazor Server app persists for a longer time than a single request.</span></span>

> [!NOTE]
> <span data-ttu-id="ebe39-166">Pendant le développement, un profileur peut être utilisé ou une trace capturée pour évaluer les demandes de mémoire des clients.</span><span class="sxs-lookup"><span data-stu-id="ebe39-166">During development, a profiler can be used or a trace captured to assess memory demands of clients.</span></span> <span data-ttu-id="ebe39-167">Un profileur ou une trace ne capture pas la mémoire allouée à un client spécifique.</span><span class="sxs-lookup"><span data-stu-id="ebe39-167">A profiler or trace won't capture the memory allocated to a specific client.</span></span> <span data-ttu-id="ebe39-168">Pour capturer l’utilisation de la mémoire d’un client spécifique lors du développement, capturez un vidage et examinez la demande de mémoire de tous les objets enracinés sur le circuit d’un utilisateur.</span><span class="sxs-lookup"><span data-stu-id="ebe39-168">To capture the memory use of a specific client during development, capture a dump and examine the memory demand of all the objects rooted at a user's circuit.</span></span>

### <a name="client-connections"></a><span data-ttu-id="ebe39-169">Connexions clientes</span><span class="sxs-lookup"><span data-stu-id="ebe39-169">Client connections</span></span>

<span data-ttu-id="ebe39-170">L’épuisement de la connexion peut se produire lorsqu’un ou plusieurs clients ouvrent un nombre trop important de connexions simultanées au serveur, empêchant ainsi d’autres clients d’établir de nouvelles connexions.</span><span class="sxs-lookup"><span data-stu-id="ebe39-170">Connection exhaustion can occur when one or more clients open too many concurrent connections to the server, preventing other clients from establishing new connections.</span></span>

<span data-ttu-id="ebe39-171">Blazor les clients établissent une connexion unique par session et maintiennent la connexion ouverte tant que la fenêtre du navigateur est ouverte.</span><span class="sxs-lookup"><span data-stu-id="ebe39-171">Blazor clients establish a single connection per session and keep the connection open for as long as the browser window is open.</span></span> <span data-ttu-id="ebe39-172">Les demandes sur le serveur de gestion de toutes les connexions ne sont pas spécifiques aux Blazor applications.</span><span class="sxs-lookup"><span data-stu-id="ebe39-172">The demands on the server of maintaining all of the connections isn't specific to Blazor apps.</span></span> <span data-ttu-id="ebe39-173">Étant donné la nature persistante des connexions et la nature des applications avec état Blazor Server , l’épuisement des connexions est un risque plus élevé pour la disponibilité de l’application.</span><span class="sxs-lookup"><span data-stu-id="ebe39-173">Given the persistent nature of the connections and the stateful nature of Blazor Server apps, connection exhaustion is a greater risk to availability of the app.</span></span>

<span data-ttu-id="ebe39-174">Par défaut, le nombre de connexions par utilisateur n’est pas limité pour une Blazor Server application.</span><span class="sxs-lookup"><span data-stu-id="ebe39-174">By default, there's no limit on the number of connections per user for a Blazor Server app.</span></span> <span data-ttu-id="ebe39-175">Si l’application requiert une limite de connexion, effectuez une ou plusieurs des approches suivantes :</span><span class="sxs-lookup"><span data-stu-id="ebe39-175">If the app requires a connection limit, take one or more of the following approaches:</span></span>

* <span data-ttu-id="ebe39-176">Exiger une authentification, ce qui limite naturellement la capacité des utilisateurs non autorisés à se connecter à l’application.</span><span class="sxs-lookup"><span data-stu-id="ebe39-176">Require authentication, which naturally limits the ability of unauthorized users to connect to the app.</span></span> <span data-ttu-id="ebe39-177">Pour que ce scénario soit efficace, les utilisateurs doivent être empêchés d’approvisionner de nouveaux utilisateurs.</span><span class="sxs-lookup"><span data-stu-id="ebe39-177">For this scenario to be effective, users must be prevented from provisioning new users at will.</span></span>
* <span data-ttu-id="ebe39-178">Limitez le nombre de connexions par utilisateur.</span><span class="sxs-lookup"><span data-stu-id="ebe39-178">Limit the number of connections per user.</span></span> <span data-ttu-id="ebe39-179">La limitation des connexions peut être accomplie à l’aide des approches suivantes.</span><span class="sxs-lookup"><span data-stu-id="ebe39-179">Limiting connections can be accomplished via the following approaches.</span></span> <span data-ttu-id="ebe39-180">Veillez à autoriser les utilisateurs légitimes à accéder à l’application (par exemple, lorsqu’une limite de connexion est établie en fonction de l’adresse IP du client).</span><span class="sxs-lookup"><span data-stu-id="ebe39-180">Exercise care to allow legitimate users to access the app (for example, when a connection limit is established based on the client's IP address).</span></span>
  * <span data-ttu-id="ebe39-181">Au niveau de l’application :</span><span class="sxs-lookup"><span data-stu-id="ebe39-181">At the app level:</span></span>
    * <span data-ttu-id="ebe39-182">Extensibilité du routage du point de terminaison.</span><span class="sxs-lookup"><span data-stu-id="ebe39-182">Endpoint routing extensibility.</span></span>
    * <span data-ttu-id="ebe39-183">Exiger une authentification pour se connecter à l’application et suivre les sessions actives par utilisateur.</span><span class="sxs-lookup"><span data-stu-id="ebe39-183">Require authentication to connect to the app and keep track of the active sessions per user.</span></span>
    * <span data-ttu-id="ebe39-184">Rejeter les nouvelles sessions après avoir atteint une limite.</span><span class="sxs-lookup"><span data-stu-id="ebe39-184">Reject new sessions upon reaching a limit.</span></span>
    * <span data-ttu-id="ebe39-185">Connexions proxy WebSocket à une application via l’utilisation d’un proxy, tel que le [ SignalR service Azure](/azure/azure-signalr/signalr-overview) qui multiplexe les connexions entre les clients et une application.</span><span class="sxs-lookup"><span data-stu-id="ebe39-185">Proxy WebSocket connections to an app through the use of a proxy, such as the [Azure SignalR Service](/azure/azure-signalr/signalr-overview) that multiplexes connections from clients to an app.</span></span> <span data-ttu-id="ebe39-186">Cela permet à une application avec une capacité de connexion supérieure à celle qu’un client unique peut établir, ce qui empêche un client d’épuiser les connexions au serveur.</span><span class="sxs-lookup"><span data-stu-id="ebe39-186">This provides an app with greater connection capacity than a single client can establish, preventing a client from exhausting the connections to the server.</span></span>
  * <span data-ttu-id="ebe39-187">Au niveau du serveur : utilisez un proxy/une passerelle devant l’application.</span><span class="sxs-lookup"><span data-stu-id="ebe39-187">At the server level: Use a proxy/gateway in front of the app.</span></span> <span data-ttu-id="ebe39-188">Par exemple, la [porte frontale Azure](/azure/frontdoor/front-door-overview) vous permet de définir, gérer et surveiller le routage global du trafic Web vers une application et fonctionne lorsque les Blazor Server applications sont configurées pour utiliser une interrogation longue.</span><span class="sxs-lookup"><span data-stu-id="ebe39-188">For example, [Azure Front Door](/azure/frontdoor/front-door-overview) enables you to define, manage, and monitor the global routing of web traffic to an app and works when Blazor Server apps are configured to use Long Polling.</span></span>
  
    > [!NOTE]
    > <span data-ttu-id="ebe39-189">Bien que l’interrogation longue soit prise en charge pour Blazor Server les applications, [WebSocket est le protocole de transport recommandé](xref:blazor/host-and-deploy/server#azure-signalr-service).</span><span class="sxs-lookup"><span data-stu-id="ebe39-189">Although Long Polling is supported for Blazor Server apps, [WebSockets is the recommended transport protocol](xref:blazor/host-and-deploy/server#azure-signalr-service).</span></span> <span data-ttu-id="ebe39-190">La [porte frontale Azure](/azure/frontdoor/front-door-overview) ne prend pas en charge WebSocket pour l’instant, mais la prise en charge de WebSockets est en cours d’examen pour une version ultérieure du service.</span><span class="sxs-lookup"><span data-stu-id="ebe39-190">[Azure Front Door](/azure/frontdoor/front-door-overview) doesn't support WebSockets at this time, but support for WebSockets is under consideration for a future release of the service.</span></span>

## <a name="denial-of-service-dos-attacks"></a><span data-ttu-id="ebe39-191">Attaques par déni de service (DoS)</span><span class="sxs-lookup"><span data-stu-id="ebe39-191">Denial of service (DoS) attacks</span></span>

<span data-ttu-id="ebe39-192">Les attaques par déni de service (DoS) impliquent un client qui oblige le serveur à épuiser une ou plusieurs de ses ressources, ce qui rend l’application indisponible.</span><span class="sxs-lookup"><span data-stu-id="ebe39-192">Denial of service (DoS) attacks involve a client causing the server to exhaust one or more of its resources making the app unavailable.</span></span> <span data-ttu-id="ebe39-193">Blazor Server les applications incluent les limites par défaut et s’appuient sur d’autres ASP.NET Core et SignalR limites pour protéger contre les attaques par déni de compte qui sont définies sur <xref:Microsoft.AspNetCore.Components.Server.CircuitOptions> :</span><span class="sxs-lookup"><span data-stu-id="ebe39-193">Blazor Server apps include default limits and rely on other ASP.NET Core and SignalR limits to protect against DoS attacks that are set on <xref:Microsoft.AspNetCore.Components.Server.CircuitOptions>:</span></span>

* <xref:Microsoft.AspNetCore.Components.Server.CircuitOptions.DisconnectedCircuitMaxRetained?displayProperty=nameWithType>
* <xref:Microsoft.AspNetCore.Components.Server.CircuitOptions.DisconnectedCircuitRetentionPeriod?displayProperty=nameWithType>
* <xref:Microsoft.AspNetCore.Components.Server.CircuitOptions.JSInteropDefaultCallTimeout?displayProperty=nameWithType>
* <xref:Microsoft.AspNetCore.Components.Server.CircuitOptions.MaxBufferedUnacknowledgedRenderBatches?displayProperty=nameWithType>
* <xref:Microsoft.AspNetCore.SignalR.HubConnectionContextOptions.MaximumReceiveMessageSize?displayProperty=nameWithType>

<span data-ttu-id="ebe39-194">Pour plus d’informations et pour obtenir des exemples de codage de configuration, consultez les articles suivants :</span><span class="sxs-lookup"><span data-stu-id="ebe39-194">For more information and configuration coding examples, see the following articles:</span></span>

* <xref:blazor/fundamentals/signalr>
* <xref:signalr/configuration>

## <a name="interactions-with-the-browser-client"></a><span data-ttu-id="ebe39-195">Interactions avec le navigateur (client)</span><span class="sxs-lookup"><span data-stu-id="ebe39-195">Interactions with the browser (client)</span></span>

<span data-ttu-id="ebe39-196">Un client interagit avec le serveur par le biais de la distribution d’événements d’interopérabilité JS et l’exécution du rendu.</span><span class="sxs-lookup"><span data-stu-id="ebe39-196">A client interacts with the server through JS interop event dispatching and render completion.</span></span> <span data-ttu-id="ebe39-197">La communication d’interopérabilité de JS s’effectue dans les deux sens entre JavaScript et .NET :</span><span class="sxs-lookup"><span data-stu-id="ebe39-197">JS interop communication goes both ways between JavaScript and .NET:</span></span>

* <span data-ttu-id="ebe39-198">Les événements du navigateur sont distribués du client au serveur de façon asynchrone.</span><span class="sxs-lookup"><span data-stu-id="ebe39-198">Browser events are dispatched from the client to the server in an asynchronous fashion.</span></span>
* <span data-ttu-id="ebe39-199">Le serveur répond de manière asynchrone à un rendu de l’interface utilisateur en fonction des besoins.</span><span class="sxs-lookup"><span data-stu-id="ebe39-199">The server responds asynchronously rerendering the UI as necessary.</span></span>

### <a name="javascript-functions-invoked-from-net"></a><span data-ttu-id="ebe39-200">Fonctions JavaScript appelées à partir de .NET</span><span class="sxs-lookup"><span data-stu-id="ebe39-200">JavaScript functions invoked from .NET</span></span>

<span data-ttu-id="ebe39-201">Pour les appels de méthodes .NET à JavaScript :</span><span class="sxs-lookup"><span data-stu-id="ebe39-201">For calls from .NET methods to JavaScript:</span></span>

* <span data-ttu-id="ebe39-202">Tous les appels ont un délai d’expiration configurable après lequel ils échouent, en retournant un <xref:System.OperationCanceledException> à l’appelant.</span><span class="sxs-lookup"><span data-stu-id="ebe39-202">All invocations have a configurable timeout after which they fail, returning a <xref:System.OperationCanceledException> to the caller.</span></span>
  * <span data-ttu-id="ebe39-203">Il y a un délai d’attente par défaut pour les appels ( <xref:Microsoft.AspNetCore.Components.Server.CircuitOptions.JSInteropDefaultCallTimeout?displayProperty=nameWithType> ) d’une minute.</span><span class="sxs-lookup"><span data-stu-id="ebe39-203">There's a default timeout for the calls (<xref:Microsoft.AspNetCore.Components.Server.CircuitOptions.JSInteropDefaultCallTimeout?displayProperty=nameWithType>) of one minute.</span></span> <span data-ttu-id="ebe39-204">Pour configurer cette limite, consultez <xref:blazor/call-javascript-from-dotnet#harden-js-interop-calls> .</span><span class="sxs-lookup"><span data-stu-id="ebe39-204">To configure this limit, see <xref:blazor/call-javascript-from-dotnet#harden-js-interop-calls>.</span></span>
  * <span data-ttu-id="ebe39-205">Un jeton d’annulation peut être fourni pour contrôler l’annulation pour chaque appel.</span><span class="sxs-lookup"><span data-stu-id="ebe39-205">A cancellation token can be provided to control the cancellation on a per-call basis.</span></span> <span data-ttu-id="ebe39-206">S’appuyer sur le délai d’attente de l’appel par défaut lorsque cela est possible et lié au temps à un appel au client si un jeton d’annulation est fourni.</span><span class="sxs-lookup"><span data-stu-id="ebe39-206">Rely on the default call timeout where possible and time-bound any call to the client if a cancellation token is provided.</span></span>
* <span data-ttu-id="ebe39-207">Le résultat d’un appel JavaScript ne peut pas être approuvé.</span><span class="sxs-lookup"><span data-stu-id="ebe39-207">The result of a JavaScript call can't be trusted.</span></span> <span data-ttu-id="ebe39-208">Le Blazor client d’application qui s’exécute dans le navigateur recherche la fonction JavaScript à appeler.</span><span class="sxs-lookup"><span data-stu-id="ebe39-208">The Blazor app client running in the browser searches for the JavaScript function to invoke.</span></span> <span data-ttu-id="ebe39-209">La fonction est appelée, et le résultat ou une erreur est généré.</span><span class="sxs-lookup"><span data-stu-id="ebe39-209">The function is invoked, and either the result or an error is produced.</span></span> <span data-ttu-id="ebe39-210">Un client malveillant peut tenter d’effectuer les opérations suivantes :</span><span class="sxs-lookup"><span data-stu-id="ebe39-210">A malicious client can attempt to:</span></span>
  * <span data-ttu-id="ebe39-211">Entraîner un problème dans l’application en renvoyant une erreur à partir de la fonction JavaScript.</span><span class="sxs-lookup"><span data-stu-id="ebe39-211">Cause an issue in the app by returning an error from the JavaScript function.</span></span>
  * <span data-ttu-id="ebe39-212">Induire un comportement inattendu sur le serveur en renvoyant un résultat inattendu de la fonction JavaScript.</span><span class="sxs-lookup"><span data-stu-id="ebe39-212">Induce an unintended behavior on the server by returning an unexpected result from the JavaScript function.</span></span>

<span data-ttu-id="ebe39-213">Prenez les précautions suivantes pour vous protéger contre les scénarios précédents :</span><span class="sxs-lookup"><span data-stu-id="ebe39-213">Take the following precautions to guard against the preceding scenarios:</span></span>

* <span data-ttu-id="ebe39-214">Encapsule les appels Interop JS dans [`try-catch`](/dotnet/csharp/language-reference/keywords/try-catch) des instructions pour tenir compte des erreurs qui peuvent se produire pendant les appels.</span><span class="sxs-lookup"><span data-stu-id="ebe39-214">Wrap JS interop calls within [`try-catch`](/dotnet/csharp/language-reference/keywords/try-catch) statements to account for errors that might occur during the invocations.</span></span> <span data-ttu-id="ebe39-215">Pour plus d’informations, consultez <xref:blazor/fundamentals/handle-errors?pivots=server#javascript-interop-server>.</span><span class="sxs-lookup"><span data-stu-id="ebe39-215">For more information, see <xref:blazor/fundamentals/handle-errors?pivots=server#javascript-interop-server>.</span></span>
* <span data-ttu-id="ebe39-216">Validez les données retournées par les appels d’interopérabilité JS, y compris les messages d’erreur, avant d’entreprendre une action.</span><span class="sxs-lookup"><span data-stu-id="ebe39-216">Validate data returned from JS interop invocations, including error messages, before taking any action.</span></span>

### <a name="net-methods-invoked-from-the-browser"></a><span data-ttu-id="ebe39-217">Méthodes .NET appelées à partir du navigateur</span><span class="sxs-lookup"><span data-stu-id="ebe39-217">.NET methods invoked from the browser</span></span>

<span data-ttu-id="ebe39-218">N’approuvez pas les appels de JavaScript aux méthodes .NET.</span><span class="sxs-lookup"><span data-stu-id="ebe39-218">Don't trust calls from JavaScript to .NET methods.</span></span> <span data-ttu-id="ebe39-219">Quand une méthode .NET est exposée à JavaScript, réfléchissez à la façon dont la méthode .NET est appelée :</span><span class="sxs-lookup"><span data-stu-id="ebe39-219">When a .NET method is exposed to JavaScript, consider how the .NET method is invoked:</span></span>

* <span data-ttu-id="ebe39-220">Traitez toute méthode .NET exposée à JavaScript comme vous le feriez pour un point de terminaison public de l’application.</span><span class="sxs-lookup"><span data-stu-id="ebe39-220">Treat any .NET method exposed to JavaScript as you would a public endpoint to the app.</span></span>
  * <span data-ttu-id="ebe39-221">Valider l’entrée.</span><span class="sxs-lookup"><span data-stu-id="ebe39-221">Validate input.</span></span>
    * <span data-ttu-id="ebe39-222">Vérifiez que les valeurs sont comprises dans les plages attendues.</span><span class="sxs-lookup"><span data-stu-id="ebe39-222">Ensure that values are within expected ranges.</span></span>
    * <span data-ttu-id="ebe39-223">Assurez-vous que l’utilisateur a l’autorisation d’effectuer l’action demandée.</span><span class="sxs-lookup"><span data-stu-id="ebe39-223">Ensure that the user has permission to perform the action requested.</span></span>
  * <span data-ttu-id="ebe39-224">N’allouez pas une quantité excessive de ressources dans le cadre de l’appel de la méthode .NET.</span><span class="sxs-lookup"><span data-stu-id="ebe39-224">Don't allocate an excessive quantity of resources as part of the .NET method invocation.</span></span> <span data-ttu-id="ebe39-225">Par exemple, effectuez des vérifications et limitez l’utilisation de l’UC et de la mémoire.</span><span class="sxs-lookup"><span data-stu-id="ebe39-225">For example, perform checks and place limits on CPU and memory use.</span></span>
  * <span data-ttu-id="ebe39-226">Prenez en compte la possibilité d’exposer des méthodes statiques et d’instance à des clients JavaScript.</span><span class="sxs-lookup"><span data-stu-id="ebe39-226">Take into account that static and instance methods can be exposed to JavaScript clients.</span></span> <span data-ttu-id="ebe39-227">Évitez de partager l’état entre les sessions, sauf si la conception appelle l’état de partage avec les contraintes appropriées.</span><span class="sxs-lookup"><span data-stu-id="ebe39-227">Avoid sharing state across sessions unless the design calls for sharing state with appropriate constraints.</span></span>
    * <span data-ttu-id="ebe39-228">Pour les méthodes d’instance exposées par le biais d' `DotNetReference` objets créés à l’origine par le biais de l’injection de dépendances, les objets doivent être inscrits en tant qu’objets délimités.</span><span class="sxs-lookup"><span data-stu-id="ebe39-228">For instance methods exposed through `DotNetReference` objects that are originally created through dependency injection (DI), the objects should be registered as scoped objects.</span></span> <span data-ttu-id="ebe39-229">Cela s’applique à tout service d’injection de services utilisé par l' Blazor Server application.</span><span class="sxs-lookup"><span data-stu-id="ebe39-229">This applies to any DI service that the Blazor Server app uses.</span></span>
    * <span data-ttu-id="ebe39-230">Pour les méthodes statiques, évitez d’établir un État qui ne peut pas être étendu au client, sauf si l’application partage explicitement l’État par conception sur tous les utilisateurs d’une instance de serveur.</span><span class="sxs-lookup"><span data-stu-id="ebe39-230">For static methods, avoid establishing state that can't be scoped to the client unless the app is explicitly sharing state by-design across all users on a server instance.</span></span>
  * <span data-ttu-id="ebe39-231">Évitez de passer des données fournies par l’utilisateur dans des paramètres à des appels JavaScript.</span><span class="sxs-lookup"><span data-stu-id="ebe39-231">Avoid passing user-supplied data in parameters to JavaScript calls.</span></span> <span data-ttu-id="ebe39-232">Si le passage de données dans des paramètres est absolument requis, assurez-vous que le code JavaScript gère le passage des données sans introduire de vulnérabilités [de script entre sites (XSS)](#cross-site-scripting-xss) .</span><span class="sxs-lookup"><span data-stu-id="ebe39-232">If passing data in parameters is absolutely required, ensure that the JavaScript code handles passing the data without introducing [Cross-site scripting (XSS)](#cross-site-scripting-xss) vulnerabilities.</span></span> <span data-ttu-id="ebe39-233">Par exemple, n’écrivez pas les données fournies par l’utilisateur dans le Document Object Model (DOM) en définissant la `innerHTML` propriété d’un élément.</span><span class="sxs-lookup"><span data-stu-id="ebe39-233">For example, don't write user-supplied data to the Document Object Model (DOM) by setting the `innerHTML` property of an element.</span></span> <span data-ttu-id="ebe39-234">Envisagez d’utiliser la [stratégie de sécurité de contenu (CSP)](https://developer.mozilla.org/docs/Web/HTTP/CSP) pour désactiver `eval` et d’autres primitives JavaScript non sûres.</span><span class="sxs-lookup"><span data-stu-id="ebe39-234">Consider using [Content Security Policy (CSP)](https://developer.mozilla.org/docs/Web/HTTP/CSP) to disable `eval` and other unsafe JavaScript primitives.</span></span>
* <span data-ttu-id="ebe39-235">Évitez d’implémenter la distribution personnalisée des appels .NET en plus de l’implémentation de la distribution du Framework.</span><span class="sxs-lookup"><span data-stu-id="ebe39-235">Avoid implementing custom dispatching of .NET invocations on top of the framework's dispatching implementation.</span></span> <span data-ttu-id="ebe39-236">L’exposition de méthodes .NET au navigateur est un scénario avancé, qui n’est pas recommandé pour le Blazor développement général.</span><span class="sxs-lookup"><span data-stu-id="ebe39-236">Exposing .NET methods to the browser is an advanced scenario, not recommended for general Blazor development.</span></span>

### <a name="events"></a><span data-ttu-id="ebe39-237">Événements</span><span class="sxs-lookup"><span data-stu-id="ebe39-237">Events</span></span>

<span data-ttu-id="ebe39-238">Les événements fournissent un point d’entrée à une Blazor Server application.</span><span class="sxs-lookup"><span data-stu-id="ebe39-238">Events provide an entry point to a Blazor Server app.</span></span> <span data-ttu-id="ebe39-239">Les mêmes règles de protection des points de terminaison dans les applications Web s’appliquent à la gestion des événements dans les Blazor Server applications.</span><span class="sxs-lookup"><span data-stu-id="ebe39-239">The same rules for safeguarding endpoints in web apps apply to event handling in Blazor Server apps.</span></span> <span data-ttu-id="ebe39-240">Un client malveillant peut envoyer toutes les données qu’il souhaite envoyer en tant que charge utile d’un événement.</span><span class="sxs-lookup"><span data-stu-id="ebe39-240">A malicious client can send any data it wishes to send as the payload for an event.</span></span>

<span data-ttu-id="ebe39-241">Par exemple :</span><span class="sxs-lookup"><span data-stu-id="ebe39-241">For example:</span></span>

* <span data-ttu-id="ebe39-242">Un événement de modification pour un `<select>` peut envoyer une valeur qui ne se trouve pas dans les options que l’application a présentées au client.</span><span class="sxs-lookup"><span data-stu-id="ebe39-242">A change event for a `<select>` could send a value that isn't within the options that the app presented to the client.</span></span>
* <span data-ttu-id="ebe39-243">Un `<input>` peut envoyer des données texte au serveur, en ignorant la validation côté client.</span><span class="sxs-lookup"><span data-stu-id="ebe39-243">An `<input>` could send any text data to the server, bypassing client-side validation.</span></span>

<span data-ttu-id="ebe39-244">L’application doit valider les données de tout événement géré par l’application.</span><span class="sxs-lookup"><span data-stu-id="ebe39-244">The app must validate the data for any event that the app handles.</span></span> <span data-ttu-id="ebe39-245">Les Blazor [composants des formulaires](xref:blazor/forms-validation) d’infrastructure effectuent des validations de base.</span><span class="sxs-lookup"><span data-stu-id="ebe39-245">The Blazor framework [forms components](xref:blazor/forms-validation) perform basic validations.</span></span> <span data-ttu-id="ebe39-246">Si l’application utilise des composants de formulaires personnalisés, du code personnalisé doit être écrit pour valider les données d’événement en fonction des besoins.</span><span class="sxs-lookup"><span data-stu-id="ebe39-246">If the app uses custom forms components, custom code must be written to validate event data as appropriate.</span></span>

<span data-ttu-id="ebe39-247">Blazor Server les événements étant asynchrones, plusieurs événements peuvent être envoyés au serveur avant que l’application ait le temps de réagir en générant un nouveau rendu.</span><span class="sxs-lookup"><span data-stu-id="ebe39-247">Blazor Server events are asynchronous, so multiple events can be dispatched to the server before the app has time to react by producing a new render.</span></span> <span data-ttu-id="ebe39-248">Cela a des implications en termes de sécurité à prendre en compte.</span><span class="sxs-lookup"><span data-stu-id="ebe39-248">This has some security implications to consider.</span></span> <span data-ttu-id="ebe39-249">La limitation des actions du client dans l’application doit être effectuée à l’intérieur des gestionnaires d’événements et ne dépend pas de l’état d’affichage affiché en cours.</span><span class="sxs-lookup"><span data-stu-id="ebe39-249">Limiting client actions in the app must be performed inside event handlers and not depend on the current rendered view state.</span></span>

<span data-ttu-id="ebe39-250">Imaginez un composant de compteur qui doit permettre à un utilisateur d’incrémenter un compteur au maximum trois fois.</span><span class="sxs-lookup"><span data-stu-id="ebe39-250">Consider a counter component that should allow a user to increment a counter a maximum of three times.</span></span> <span data-ttu-id="ebe39-251">Le bouton permettant d’incrémenter le compteur dépend de la valeur de `count` :</span><span class="sxs-lookup"><span data-stu-id="ebe39-251">The button to increment the counter is conditionally based on the value of `count`:</span></span>

```razor
<p>Count: @count<p>

@if (count < 3)
{
    <button @onclick="IncrementCount" value="Increment count" />
}

@code 
{
    private int count = 0;

    private void IncrementCount()
    {
        count++;
    }
}
```

<span data-ttu-id="ebe39-252">Un client peut distribuer un ou plusieurs événements d’incréments avant que l’infrastructure génère un nouveau rendu de ce composant.</span><span class="sxs-lookup"><span data-stu-id="ebe39-252">A client can dispatch one or more increment events before the framework produces a new render of this component.</span></span> <span data-ttu-id="ebe39-253">Le résultat est que l' `count` peut être incrémenté de *trois fois* par l’utilisateur, car le bouton n’est pas supprimé rapidement par l’interface utilisateur.</span><span class="sxs-lookup"><span data-stu-id="ebe39-253">The result is that the `count` can be incremented *over three times* by the user because the button isn't removed by the UI quickly enough.</span></span> <span data-ttu-id="ebe39-254">La méthode correcte pour atteindre la limite de trois `count` incréments est illustrée dans l’exemple suivant :</span><span class="sxs-lookup"><span data-stu-id="ebe39-254">The correct way to achieve the limit of three `count` increments is shown in the following example:</span></span>

```razor
<p>Count: @count<p>

@if (count < 3)
{
    <button @onclick="IncrementCount" value="Increment count" />
}

@code 
{
    private int count = 0;

    private void IncrementCount()
    {
        if (count < 3)
        {
            count++;
        }
    }
}
```

<span data-ttu-id="ebe39-255">En ajoutant la `if (count < 3) { ... }` vérification à l’intérieur du gestionnaire, la décision d’incrémentation `count` est basée sur l’état actuel de l’application.</span><span class="sxs-lookup"><span data-stu-id="ebe39-255">By adding the `if (count < 3) { ... }` check inside the handler, the decision to increment `count` is based on the current app state.</span></span> <span data-ttu-id="ebe39-256">La décision n’est pas basée sur l’état de l’interface utilisateur tel qu’il était dans l’exemple précédent, qui peut être temporairement périmé.</span><span class="sxs-lookup"><span data-stu-id="ebe39-256">The decision isn't based on the state of the UI as it was in the previous example, which might be temporarily stale.</span></span>

### <a name="guard-against-multiple-dispatches"></a><span data-ttu-id="ebe39-257">Protégez-vous contre plusieurs distributions</span><span class="sxs-lookup"><span data-stu-id="ebe39-257">Guard against multiple dispatches</span></span>

<span data-ttu-id="ebe39-258">Si un rappel d’événement appelle une opération de longue durée de manière asynchrone, comme l’extraction de données à partir d’un service externe ou d’une base de données, envisagez d’utiliser une protection.</span><span class="sxs-lookup"><span data-stu-id="ebe39-258">If an event callback invokes a long running operation asynchronously, such as fetching data from an external service or database, consider using a guard.</span></span> <span data-ttu-id="ebe39-259">La protection peut empêcher l’utilisateur de faire passer plusieurs opérations en file d’attente pendant que l’opération est en cours avec des commentaires visuels.</span><span class="sxs-lookup"><span data-stu-id="ebe39-259">The guard can prevent the user from queueing up multiple operations while the operation is in progress with visual feedback.</span></span> <span data-ttu-id="ebe39-260">Le code du composant suivant affecte `isLoading` à `true` la valeur en cours d' `GetForecastAsync` obtention des données du serveur.</span><span class="sxs-lookup"><span data-stu-id="ebe39-260">The following component code sets `isLoading` to `true` while `GetForecastAsync` obtains data from the server.</span></span> <span data-ttu-id="ebe39-261">Tandis que `isLoading` est `true` , le bouton est désactivé dans l’interface utilisateur :</span><span class="sxs-lookup"><span data-stu-id="ebe39-261">While `isLoading` is `true`, the button is disabled in the UI:</span></span>

```razor
@page "/fetchdata"
@using BlazorServerSample.Data
@inject WeatherForecastService ForecastService

<button disabled="@isLoading" @onclick="UpdateForecasts">Update</button>

@code {
    private bool isLoading;
    private WeatherForecast[] forecasts;

    private async Task UpdateForecasts()
    {
        if (!isLoading)
        {
            isLoading = true;
            forecasts = await ForecastService.GetForecastAsync(DateTime.Now);
            isLoading = false;
        }
    }
}
```

<span data-ttu-id="ebe39-262">Le modèle de protection illustré dans l’exemple précédent fonctionne si l’opération d’arrière-plan est exécutée de façon asynchrone avec le `async` - `await` modèle.</span><span class="sxs-lookup"><span data-stu-id="ebe39-262">The guard pattern demonstrated in the preceding example works if the background operation is executed asynchronously with the `async`-`await` pattern.</span></span>

### <a name="cancel-early-and-avoid-use-after-dispose"></a><span data-ttu-id="ebe39-263">Annuler tôt et éviter d’utiliser-after-dispose</span><span class="sxs-lookup"><span data-stu-id="ebe39-263">Cancel early and avoid use-after-dispose</span></span>

<span data-ttu-id="ebe39-264">En plus d’utiliser une protection comme décrit dans la section [protection contre plusieurs distributions](#guard-against-multiple-dispatches) , envisagez d’utiliser un <xref:System.Threading.CancellationToken> pour annuler les opérations de longue durée lorsque le composant est supprimé.</span><span class="sxs-lookup"><span data-stu-id="ebe39-264">In addition to using a guard as described in the [Guard against multiple dispatches](#guard-against-multiple-dispatches) section, consider using a <xref:System.Threading.CancellationToken> to cancel long-running operations when the component is disposed.</span></span> <span data-ttu-id="ebe39-265">Cette approche présente l’avantage supplémentaire d’éviter l' *utilisation de-after-dispose dans les* composants :</span><span class="sxs-lookup"><span data-stu-id="ebe39-265">This approach has the added benefit of avoiding *use-after-dispose* in components:</span></span>

```razor
@implements IDisposable

...

@code {
    private readonly CancellationTokenSource TokenSource = 
        new CancellationTokenSource();

    private async Task UpdateForecasts()
    {
        ...

        forecasts = await ForecastService.GetForecastAsync(DateTime.Now, 
            TokenSource.Token);

        if (TokenSource.Token.IsCancellationRequested)
        {
           return;
        }

        ...
    }

    public void Dispose()
    {
        TokenSource.Cancel();
    }
}
```

### <a name="avoid-events-that-produce-large-amounts-of-data"></a><span data-ttu-id="ebe39-266">Évitez les événements qui génèrent de grandes quantités de données</span><span class="sxs-lookup"><span data-stu-id="ebe39-266">Avoid events that produce large amounts of data</span></span>

<span data-ttu-id="ebe39-267">Certains événements DOM, tels que `oninput` ou `onscroll` , peuvent générer une grande quantité de données.</span><span class="sxs-lookup"><span data-stu-id="ebe39-267">Some DOM events, such as `oninput` or `onscroll`, can produce a large amount of data.</span></span> <span data-ttu-id="ebe39-268">Évitez d’utiliser ces événements dans les Blazor applications serveur.</span><span class="sxs-lookup"><span data-stu-id="ebe39-268">Avoid using these events in Blazor server apps.</span></span>

## <a name="additional-security-guidance"></a><span data-ttu-id="ebe39-269">Aide supplémentaire sur la sécurité</span><span class="sxs-lookup"><span data-stu-id="ebe39-269">Additional security guidance</span></span>

<span data-ttu-id="ebe39-270">Les conseils pour la sécurisation des applications ASP.NET Core s’appliquent aux Blazor Server applications et sont traités dans les sections suivantes :</span><span class="sxs-lookup"><span data-stu-id="ebe39-270">The guidance for securing ASP.NET Core apps apply to Blazor Server apps and are covered in the following sections:</span></span>

* [<span data-ttu-id="ebe39-271">Journalisation et données sensibles</span><span class="sxs-lookup"><span data-stu-id="ebe39-271">Logging and sensitive data</span></span>](#logging-and-sensitive-data)
* [<span data-ttu-id="ebe39-272">Protéger les informations en transit avec HTTPs</span><span class="sxs-lookup"><span data-stu-id="ebe39-272">Protect information in transit with HTTPS</span></span>](#protect-information-in-transit-with-https)
* [<span data-ttu-id="ebe39-273">Scripts inter-sites (XSS)</span><span class="sxs-lookup"><span data-stu-id="ebe39-273">Cross-site scripting (XSS)</span></span>](#cross-site-scripting-xss)
* [<span data-ttu-id="ebe39-274">Protection Cross-Origin</span><span class="sxs-lookup"><span data-stu-id="ebe39-274">Cross-origin protection</span></span>](#cross-origin-protection)
* [<span data-ttu-id="ebe39-275">Prise de la clic</span><span class="sxs-lookup"><span data-stu-id="ebe39-275">Click-jacking</span></span>](#click-jacking)
* [<span data-ttu-id="ebe39-276">Ouvrir les redirections</span><span class="sxs-lookup"><span data-stu-id="ebe39-276">Open redirects</span></span>](#open-redirects)

### <a name="logging-and-sensitive-data"></a><span data-ttu-id="ebe39-277">Journalisation et données sensibles</span><span class="sxs-lookup"><span data-stu-id="ebe39-277">Logging and sensitive data</span></span>

<span data-ttu-id="ebe39-278">Les interactions d’interopérabilité JS entre le client et le serveur sont enregistrées dans les journaux du serveur avec des <xref:Microsoft.Extensions.Logging.ILogger> instances.</span><span class="sxs-lookup"><span data-stu-id="ebe39-278">JS interop interactions between the client and server are recorded in the server's logs with <xref:Microsoft.Extensions.Logging.ILogger> instances.</span></span> <span data-ttu-id="ebe39-279">Blazor évite la journalisation des informations sensibles, telles que les événements réels ou les entrées et sorties d’interopérabilité JS.</span><span class="sxs-lookup"><span data-stu-id="ebe39-279">Blazor avoids logging sensitive information, such as actual events or JS interop inputs and outputs.</span></span>

<span data-ttu-id="ebe39-280">Lorsqu’une erreur se produit sur le serveur, le Framework avertit le client et ferme la session.</span><span class="sxs-lookup"><span data-stu-id="ebe39-280">When an error occurs on the server, the framework notifies the client and tears down the session.</span></span> <span data-ttu-id="ebe39-281">Par défaut, le client reçoit un message d’erreur générique qui peut être affiché dans les outils de développement du navigateur.</span><span class="sxs-lookup"><span data-stu-id="ebe39-281">By default, the client receives a generic error message that can be seen in the browser's developer tools.</span></span>

<span data-ttu-id="ebe39-282">L’erreur côté client n’inclut pas la pile des appels et ne fournit pas de détails sur la cause de l’erreur, mais les journaux du serveur contiennent ces informations.</span><span class="sxs-lookup"><span data-stu-id="ebe39-282">The client-side error doesn't include the call stack and doesn't provide detail on the cause of the error, but server logs do contain such information.</span></span> <span data-ttu-id="ebe39-283">À des fins de développement, les informations d’erreur sensibles peuvent être mises à la disposition du client en [activant les erreurs détaillées](xref:blazor/fundamentals/handle-errors#blazor-server-detailed-circuit-errors).</span><span class="sxs-lookup"><span data-stu-id="ebe39-283">For development purposes, sensitive error information can be made available to the client by [enabling detailed errors](xref:blazor/fundamentals/handle-errors#blazor-server-detailed-circuit-errors).</span></span>

> [!WARNING]
> <span data-ttu-id="ebe39-284">L’exposition des informations sur les erreurs aux clients sur Internet est un risque de sécurité qui doit toujours être évité.</span><span class="sxs-lookup"><span data-stu-id="ebe39-284">Exposing error information to clients on the Internet is a security risk that should always be avoided.</span></span>

### <a name="protect-information-in-transit-with-https"></a><span data-ttu-id="ebe39-285">Protéger les informations en transit avec HTTPs</span><span class="sxs-lookup"><span data-stu-id="ebe39-285">Protect information in transit with HTTPS</span></span>

<span data-ttu-id="ebe39-286">Blazor Server utilise SignalR pour la communication entre le client et le serveur.</span><span class="sxs-lookup"><span data-stu-id="ebe39-286">Blazor Server uses SignalR for communication between the client and the server.</span></span> <span data-ttu-id="ebe39-287">Blazor Server utilise normalement le transport qui SignalR négocie, qui est généralement WebSocket.</span><span class="sxs-lookup"><span data-stu-id="ebe39-287">Blazor Server normally uses the transport that SignalR negotiates, which is typically WebSockets.</span></span>

<span data-ttu-id="ebe39-288">Blazor Server ne garantit pas l’intégrité et la confidentialité des données envoyées entre le serveur et le client.</span><span class="sxs-lookup"><span data-stu-id="ebe39-288">Blazor Server doesn't ensure the integrity and confidentiality of the data sent between the server and the client.</span></span> <span data-ttu-id="ebe39-289">Utilisez toujours le protocole HTTPs.</span><span class="sxs-lookup"><span data-stu-id="ebe39-289">Always use HTTPS.</span></span>

### <a name="cross-site-scripting-xss"></a><span data-ttu-id="ebe39-290">Scripts inter-sites (XSS)</span><span class="sxs-lookup"><span data-stu-id="ebe39-290">Cross-site scripting (XSS)</span></span>

<span data-ttu-id="ebe39-291">Les scripts entre sites (XSS) permettent à une partie non autorisée d’exécuter une logique arbitraire dans le contexte du navigateur.</span><span class="sxs-lookup"><span data-stu-id="ebe39-291">Cross-site scripting (XSS) allows an unauthorized party to execute arbitrary logic in the context of the browser.</span></span> <span data-ttu-id="ebe39-292">Une application compromise peut potentiellement exécuter du code arbitraire sur le client.</span><span class="sxs-lookup"><span data-stu-id="ebe39-292">A compromised app could potentially run arbitrary code on the client.</span></span> <span data-ttu-id="ebe39-293">La vulnérabilité peut être utilisée pour exécuter potentiellement des actions malveillantes sur le serveur :</span><span class="sxs-lookup"><span data-stu-id="ebe39-293">The vulnerability could be used to potentially perform a number of malicious actions against the server:</span></span>

* <span data-ttu-id="ebe39-294">Distribuer des événements factices/non valides au serveur.</span><span class="sxs-lookup"><span data-stu-id="ebe39-294">Dispatch fake/invalid events to the server.</span></span>
* <span data-ttu-id="ebe39-295">Réussites d’échec de distribution/rendu non valide.</span><span class="sxs-lookup"><span data-stu-id="ebe39-295">Dispatch fail/invalid render completions.</span></span>
* <span data-ttu-id="ebe39-296">Évitez de distribuer les saisies semi-automatiques de rendu.</span><span class="sxs-lookup"><span data-stu-id="ebe39-296">Avoid dispatching render completions.</span></span>
* <span data-ttu-id="ebe39-297">Dispatch des appels d’interopérabilité de JavaScript à .NET.</span><span class="sxs-lookup"><span data-stu-id="ebe39-297">Dispatch interop calls from JavaScript to .NET.</span></span>
* <span data-ttu-id="ebe39-298">Modifiez la réponse des appels d’interopérabilité de .NET à JavaScript.</span><span class="sxs-lookup"><span data-stu-id="ebe39-298">Modify the response of interop calls from .NET to JavaScript.</span></span>
* <span data-ttu-id="ebe39-299">Évitez de distribuer les résultats de l’interopérabilité de .NET vers JS.</span><span class="sxs-lookup"><span data-stu-id="ebe39-299">Avoid dispatching .NET to JS interop results.</span></span>

<span data-ttu-id="ebe39-300">L' Blazor Server infrastructure prend des mesures pour se protéger contre certaines des menaces précédentes :</span><span class="sxs-lookup"><span data-stu-id="ebe39-300">The Blazor Server framework takes steps to protect against some of the preceding threats:</span></span>

* <span data-ttu-id="ebe39-301">Arrête la génération de nouvelles mises à jour de l’interface utilisateur si le client n’accuse pas réception des lots de rendu.</span><span class="sxs-lookup"><span data-stu-id="ebe39-301">Stops producing new UI updates if the client isn't acknowledging render batches.</span></span> <span data-ttu-id="ebe39-302">Configuré avec <xref:Microsoft.AspNetCore.Components.Server.CircuitOptions.MaxBufferedUnacknowledgedRenderBatches?displayProperty=nameWithType> .</span><span class="sxs-lookup"><span data-stu-id="ebe39-302">Configured with <xref:Microsoft.AspNetCore.Components.Server.CircuitOptions.MaxBufferedUnacknowledgedRenderBatches?displayProperty=nameWithType>.</span></span>
* <span data-ttu-id="ebe39-303">Expire un appel de .NET à JavaScript après une minute sans recevoir de réponse du client.</span><span class="sxs-lookup"><span data-stu-id="ebe39-303">Times out any .NET to JavaScript call after one minute without receiving a response from the client.</span></span> <span data-ttu-id="ebe39-304">Configuré avec <xref:Microsoft.AspNetCore.Components.Server.CircuitOptions.JSInteropDefaultCallTimeout?displayProperty=nameWithType> .</span><span class="sxs-lookup"><span data-stu-id="ebe39-304">Configured with <xref:Microsoft.AspNetCore.Components.Server.CircuitOptions.JSInteropDefaultCallTimeout?displayProperty=nameWithType>.</span></span>
* <span data-ttu-id="ebe39-305">Effectue une validation de base sur toutes les entrées provenant du navigateur pendant l’interopérabilité de JS :</span><span class="sxs-lookup"><span data-stu-id="ebe39-305">Performs basic validation on all input coming from the browser during JS interop:</span></span>
  * <span data-ttu-id="ebe39-306">Les références .NET sont valides et du type attendu par la méthode .NET.</span><span class="sxs-lookup"><span data-stu-id="ebe39-306">.NET references are valid and of the type expected by the .NET method.</span></span>
  * <span data-ttu-id="ebe39-307">Les données ne sont pas incorrectes.</span><span class="sxs-lookup"><span data-stu-id="ebe39-307">The data isn't malformed.</span></span>
  * <span data-ttu-id="ebe39-308">Le nombre correct d’arguments pour la méthode est présent dans la charge utile.</span><span class="sxs-lookup"><span data-stu-id="ebe39-308">The correct number of arguments for the method are present in the payload.</span></span>
  * <span data-ttu-id="ebe39-309">Les arguments ou le résultat peuvent être désérialisés correctement avant l’appel de la méthode.</span><span class="sxs-lookup"><span data-stu-id="ebe39-309">The arguments or result can be deserialized correctly before invoking the method.</span></span>
* <span data-ttu-id="ebe39-310">Effectue une validation de base dans toutes les entrées provenant du navigateur à partir d’événements distribués :</span><span class="sxs-lookup"><span data-stu-id="ebe39-310">Performs basic validation in all input coming from the browser from dispatched events:</span></span>
  * <span data-ttu-id="ebe39-311">Le type de l’événement est valide.</span><span class="sxs-lookup"><span data-stu-id="ebe39-311">The event has a valid type.</span></span>
  * <span data-ttu-id="ebe39-312">Les données de l’événement peuvent être désérialisées.</span><span class="sxs-lookup"><span data-stu-id="ebe39-312">The data for the event can be deserialized.</span></span>
  * <span data-ttu-id="ebe39-313">Un gestionnaire d’événements est associé à l’événement.</span><span class="sxs-lookup"><span data-stu-id="ebe39-313">There's an event handler associated with the event.</span></span>

<span data-ttu-id="ebe39-314">Outre les protections implémentées par le Framework, l’application doit être codée par le développeur pour se protéger contre les menaces et prendre les mesures appropriées :</span><span class="sxs-lookup"><span data-stu-id="ebe39-314">In addition to the safeguards that the framework implements, the app must be coded by the developer to safeguard against threats and take appropriate actions:</span></span>

* <span data-ttu-id="ebe39-315">Valide toujours les données lors de la gestion des événements.</span><span class="sxs-lookup"><span data-stu-id="ebe39-315">Always validate data when handling events.</span></span>
* <span data-ttu-id="ebe39-316">Prenez les mesures nécessaires lors de la réception de données non valides :</span><span class="sxs-lookup"><span data-stu-id="ebe39-316">Take appropriate action upon receiving invalid data:</span></span>
  * <span data-ttu-id="ebe39-317">Ignorez les données et retournez.</span><span class="sxs-lookup"><span data-stu-id="ebe39-317">Ignore the data and return.</span></span> <span data-ttu-id="ebe39-318">Cela permet à l’application de continuer à traiter les demandes.</span><span class="sxs-lookup"><span data-stu-id="ebe39-318">This allows the app to continue processing requests.</span></span>
  * <span data-ttu-id="ebe39-319">Si l’application détermine que l’entrée est illégitime et ne peut pas être produite par un client légitime, levez une exception.</span><span class="sxs-lookup"><span data-stu-id="ebe39-319">If the app determines that the input is illegitimate and couldn't be produced by legitimate client, throw an exception.</span></span> <span data-ttu-id="ebe39-320">La levée d’une exception interrompt le circuit et met fin à la session.</span><span class="sxs-lookup"><span data-stu-id="ebe39-320">Throwing an exception tears down the circuit and ends the session.</span></span>
* <span data-ttu-id="ebe39-321">N’approuvez pas le message d’erreur fourni par les saisies semi-automatiques de lot incluses dans les journaux.</span><span class="sxs-lookup"><span data-stu-id="ebe39-321">Don't trust the error message provided by render batch completions included in the logs.</span></span> <span data-ttu-id="ebe39-322">L’erreur est fournie par le client et ne peut généralement pas être approuvée, car le client risque d’être compromis.</span><span class="sxs-lookup"><span data-stu-id="ebe39-322">The error is provided by the client and can't generally be trusted, as the client might be compromised.</span></span>
* <span data-ttu-id="ebe39-323">N’approuvez pas l’entrée dans les appels d’interopérabilité JS dans les deux sens entre les méthodes JavaScript et .NET.</span><span class="sxs-lookup"><span data-stu-id="ebe39-323">Don't trust the input on JS interop calls in either direction between JavaScript and .NET methods.</span></span>
* <span data-ttu-id="ebe39-324">L’application est chargée de valider le fait que le contenu des arguments et les résultats sont valides, même si les arguments ou les résultats sont correctement désérialisés.</span><span class="sxs-lookup"><span data-stu-id="ebe39-324">The app is responsible for validating that the content of arguments and results are valid, even if the arguments or results are correctly deserialized.</span></span>

<span data-ttu-id="ebe39-325">Pour qu’une vulnérabilité XSS existe, l’application doit incorporer une entrée d’utilisateur dans la page rendue.</span><span class="sxs-lookup"><span data-stu-id="ebe39-325">For a XSS vulnerability to exist, the app must incorporate user input in the rendered page.</span></span> <span data-ttu-id="ebe39-326">Blazor Server les composants exécutent une étape de compilation dans laquelle le balisage d’un `.razor` fichier est transformé en logique C# procédurale.</span><span class="sxs-lookup"><span data-stu-id="ebe39-326">Blazor Server components execute a compile-time step where the markup in a `.razor` file is transformed into procedural C# logic.</span></span> <span data-ttu-id="ebe39-327">Au moment de l’exécution, la logique C# génère une *arborescence de rendu* décrivant les éléments, le texte et les composants enfants.</span><span class="sxs-lookup"><span data-stu-id="ebe39-327">At runtime, the C# logic builds a *render tree* describing the elements, text, and child components.</span></span> <span data-ttu-id="ebe39-328">Elle est appliquée au DOM du navigateur via une séquence d’instructions JavaScript (ou est sérialisée en HTML dans le cas du prérendu) :</span><span class="sxs-lookup"><span data-stu-id="ebe39-328">This is applied to the browser's DOM via a sequence of JavaScript instructions (or is serialized to HTML in the case of prerendering):</span></span>

* <span data-ttu-id="ebe39-329">L’entrée utilisateur rendue via Razor une syntaxe normale (par exemple, `@someStringValue` ) n’expose pas de vulnérabilité XSS car la Razor syntaxe est ajoutée au DOM via des commandes qui peuvent uniquement écrire du texte.</span><span class="sxs-lookup"><span data-stu-id="ebe39-329">User input rendered via normal Razor syntax (for example, `@someStringValue`) doesn't expose a XSS vulnerability because the Razor syntax is added to the DOM via commands that can only write text.</span></span> <span data-ttu-id="ebe39-330">Même si la valeur comprend le balisage HTML, la valeur est affichée sous forme de texte statique.</span><span class="sxs-lookup"><span data-stu-id="ebe39-330">Even if the value includes HTML markup, the value is displayed as static text.</span></span> <span data-ttu-id="ebe39-331">Lors du prérendu, la sortie est codée au format HTML, ce qui affiche également le contenu sous forme de texte statique.</span><span class="sxs-lookup"><span data-stu-id="ebe39-331">When prerendering, the output is HTML-encoded, which also displays the content as static text.</span></span>
* <span data-ttu-id="ebe39-332">Les balises de script ne sont pas autorisées et ne doivent pas être incluses dans l’arborescence de rendu des composants de l’application.</span><span class="sxs-lookup"><span data-stu-id="ebe39-332">Script tags aren't allowed and shouldn't be included in the app's component render tree.</span></span> <span data-ttu-id="ebe39-333">Si une balise de script est incluse dans le balisage d’un composant, une erreur de compilation est générée.</span><span class="sxs-lookup"><span data-stu-id="ebe39-333">If a script tag is included in a component's markup, a compile-time error is generated.</span></span>
* <span data-ttu-id="ebe39-334">Les auteurs de composants peuvent créer des composants en C# sans utiliser Razor .</span><span class="sxs-lookup"><span data-stu-id="ebe39-334">Component authors can author components in C# without using Razor.</span></span> <span data-ttu-id="ebe39-335">L’auteur du composant est chargé d’utiliser les API appropriées lors de l’émission de la sortie.</span><span class="sxs-lookup"><span data-stu-id="ebe39-335">The component author is responsible for using the correct APIs when emitting output.</span></span> <span data-ttu-id="ebe39-336">Par exemple, utilisez `builder.AddContent(0, someUserSuppliedString)` et *non* `builder.AddMarkupContent(0, someUserSuppliedString)` , car ces derniers peuvent créer une vulnérabilité XSS.</span><span class="sxs-lookup"><span data-stu-id="ebe39-336">For example, use `builder.AddContent(0, someUserSuppliedString)` and *not* `builder.AddMarkupContent(0, someUserSuppliedString)`, as the latter could create a XSS vulnerability.</span></span>

<span data-ttu-id="ebe39-337">Dans le cadre de la protection contre les attaques XSS, envisagez d’implémenter des atténuations XSS, telles que la [stratégie de sécurité du contenu (CSP)](https://developer.mozilla.org/docs/Web/HTTP/CSP).</span><span class="sxs-lookup"><span data-stu-id="ebe39-337">As part of protecting against XSS attacks, consider implementing XSS mitigations, such as [Content Security Policy (CSP)](https://developer.mozilla.org/docs/Web/HTTP/CSP).</span></span>

<span data-ttu-id="ebe39-338">Pour plus d’informations, consultez <xref:security/cross-site-scripting>.</span><span class="sxs-lookup"><span data-stu-id="ebe39-338">For more information, see <xref:security/cross-site-scripting>.</span></span>

### <a name="cross-origin-protection"></a><span data-ttu-id="ebe39-339">Protection Cross-Origin</span><span class="sxs-lookup"><span data-stu-id="ebe39-339">Cross-origin protection</span></span>

<span data-ttu-id="ebe39-340">Les attaques Cross-Origin impliquent un client à partir d’une origine différente qui effectue une action sur le serveur.</span><span class="sxs-lookup"><span data-stu-id="ebe39-340">Cross-origin attacks involve a client from a different origin performing an action against the server.</span></span> <span data-ttu-id="ebe39-341">L’action malveillante est généralement une requête d’extraction ou une publication de formulaire (falsification de requête intersite, CSRF), mais l’ouverture d’un WebSocket malveillant est également possible.</span><span class="sxs-lookup"><span data-stu-id="ebe39-341">The malicious action is typically a GET request or a form POST (Cross-Site Request Forgery, CSRF), but opening a malicious WebSocket is also possible.</span></span> <span data-ttu-id="ebe39-342">Blazor Server les applications offrent [les mêmes garanties que toute autre SignalR application qui utilise le protocole de concentrateur](xref:signalr/security):</span><span class="sxs-lookup"><span data-stu-id="ebe39-342">Blazor Server apps offer [the same guarantees that any other SignalR app using the hub protocol offer](xref:signalr/security):</span></span>

* <span data-ttu-id="ebe39-343">Blazor Server Il est possible d’accéder à des applications Cross-Origin, sauf si des mesures supplémentaires sont prises pour l’empêcher.</span><span class="sxs-lookup"><span data-stu-id="ebe39-343">Blazor Server apps can be accessed cross-origin unless additional measures are taken to prevent it.</span></span> <span data-ttu-id="ebe39-344">Pour désactiver l’accès Cross-Origin, désactivez CORS dans le point de terminaison en ajoutant l’intergiciel (middleware) CORS au pipeline et en ajoutant le <xref:Microsoft.AspNetCore.Cors.DisableCorsAttribute> aux Blazor métadonnées du point de terminaison ou limitez le jeu d’origines autorisées en [configurant le SignalR partage des ressources Cross-Origin](xref:signalr/security#cross-origin-resource-sharing).</span><span class="sxs-lookup"><span data-stu-id="ebe39-344">To disable cross-origin access, either disable CORS in the endpoint by adding the CORS middleware to the pipeline and adding the <xref:Microsoft.AspNetCore.Cors.DisableCorsAttribute> to the Blazor endpoint metadata or limit the set of allowed origins by [configuring SignalR for cross-origin resource sharing](xref:signalr/security#cross-origin-resource-sharing).</span></span>
* <span data-ttu-id="ebe39-345">Si CORS est activé, des étapes supplémentaires peuvent être nécessaires pour protéger l’application en fonction de la configuration CORS.</span><span class="sxs-lookup"><span data-stu-id="ebe39-345">If CORS is enabled, extra steps might be required to protect the app depending on the CORS configuration.</span></span> <span data-ttu-id="ebe39-346">Si CORS est activé globalement, CORS peut être désactivé pour le Blazor Server concentrateur en ajoutant les <xref:Microsoft.AspNetCore.Cors.DisableCorsAttribute> métadonnées aux métadonnées de point de terminaison après avoir appelé <xref:Microsoft.AspNetCore.Builder.ComponentEndpointRouteBuilderExtensions.MapBlazorHub%2A> sur le générateur d’itinéraire de point de terminaison.</span><span class="sxs-lookup"><span data-stu-id="ebe39-346">If CORS is globally enabled, CORS can be disabled for the Blazor Server hub by adding the <xref:Microsoft.AspNetCore.Cors.DisableCorsAttribute> metadata to the endpoint metadata after calling <xref:Microsoft.AspNetCore.Builder.ComponentEndpointRouteBuilderExtensions.MapBlazorHub%2A> on the endpoint route builder.</span></span>

<span data-ttu-id="ebe39-347">Pour plus d’informations, consultez <xref:security/anti-request-forgery>.</span><span class="sxs-lookup"><span data-stu-id="ebe39-347">For more information, see <xref:security/anti-request-forgery>.</span></span>

### <a name="click-jacking"></a><span data-ttu-id="ebe39-348">Prise de la clic</span><span class="sxs-lookup"><span data-stu-id="ebe39-348">Click-jacking</span></span>

<span data-ttu-id="ebe39-349">La prise de vue implique le rendu d’un site en tant qu’à `<iframe>` l’intérieur d’un site à partir d’une origine différente afin d’inciter l’utilisateur à effectuer des actions sur le site en cas d’attaque.</span><span class="sxs-lookup"><span data-stu-id="ebe39-349">Click-jacking involves rendering a site as an `<iframe>` inside a site from a different origin in order to trick the user into performing actions on the site under attack.</span></span>

<span data-ttu-id="ebe39-350">Pour protéger une application du rendu à l’intérieur d’un `<iframe>` , utilisez la [stratégie de sécurité du contenu (CSP)](https://developer.mozilla.org/docs/Web/HTTP/CSP) et l' `X-Frame-Options` en-tête.</span><span class="sxs-lookup"><span data-stu-id="ebe39-350">To protect an app from rendering inside of an `<iframe>`, use [Content Security Policy (CSP)](https://developer.mozilla.org/docs/Web/HTTP/CSP) and the `X-Frame-Options` header.</span></span> <span data-ttu-id="ebe39-351">Pour plus d’informations, consultez [MDN Web docs : X-Frame-options](https://developer.mozilla.org/docs/Web/HTTP/Headers/X-Frame-Options).</span><span class="sxs-lookup"><span data-stu-id="ebe39-351">For more information, see [MDN web docs: X-Frame-Options](https://developer.mozilla.org/docs/Web/HTTP/Headers/X-Frame-Options).</span></span>

### <a name="open-redirects"></a><span data-ttu-id="ebe39-352">Ouvrir les redirections</span><span class="sxs-lookup"><span data-stu-id="ebe39-352">Open redirects</span></span>

<span data-ttu-id="ebe39-353">Lorsqu’une Blazor Server session d’application démarre, le serveur effectue une validation de base des URL envoyées dans le cadre du démarrage de la session.</span><span class="sxs-lookup"><span data-stu-id="ebe39-353">When a Blazor Server app session starts, the server performs basic validation of the URLs sent as part of starting the session.</span></span> <span data-ttu-id="ebe39-354">L’infrastructure vérifie que l’URL de base est un parent de l’URL actuelle avant d’établir le circuit.</span><span class="sxs-lookup"><span data-stu-id="ebe39-354">The framework checks that the base URL is a parent of the current URL before establishing the circuit.</span></span> <span data-ttu-id="ebe39-355">Aucune vérification supplémentaire n’est effectuée par l’infrastructure.</span><span class="sxs-lookup"><span data-stu-id="ebe39-355">No additional checks are performed by the framework.</span></span>

<span data-ttu-id="ebe39-356">Lorsqu’un utilisateur sélectionne un lien sur le client, l’URL du lien est envoyée au serveur, qui détermine l’action à entreprendre.</span><span class="sxs-lookup"><span data-stu-id="ebe39-356">When a user selects a link on the client, the URL for the link is sent to the server, which determines what action to take.</span></span> <span data-ttu-id="ebe39-357">Par exemple, l’application peut effectuer une navigation côté client ou indiquer au navigateur d’accéder au nouvel emplacement.</span><span class="sxs-lookup"><span data-stu-id="ebe39-357">For example, the app may perform a client-side navigation or indicate to the browser to go to the new location.</span></span>

<span data-ttu-id="ebe39-358">Les composants peuvent également déclencher des requêtes de navigation par programmation par le biais de l’utilisation de <xref:Microsoft.AspNetCore.Components.NavigationManager> .</span><span class="sxs-lookup"><span data-stu-id="ebe39-358">Components can also trigger navigation requests programatically through the use of <xref:Microsoft.AspNetCore.Components.NavigationManager>.</span></span> <span data-ttu-id="ebe39-359">Dans de tels scénarios, l’application peut effectuer une navigation côté client ou indiquer au navigateur d’accéder au nouvel emplacement.</span><span class="sxs-lookup"><span data-stu-id="ebe39-359">In such scenarios, the app might perform a client-side navigation or indicate to the browser to go to the new location.</span></span>

<span data-ttu-id="ebe39-360">Les composants doivent :</span><span class="sxs-lookup"><span data-stu-id="ebe39-360">Components must:</span></span>

* <span data-ttu-id="ebe39-361">Évitez d’utiliser l’entrée utilisateur dans le cadre des arguments de l’appel de navigation.</span><span class="sxs-lookup"><span data-stu-id="ebe39-361">Avoid using user input as part of the navigation call arguments.</span></span>
* <span data-ttu-id="ebe39-362">Validez les arguments pour vous assurer que l’application peut autoriser la cible.</span><span class="sxs-lookup"><span data-stu-id="ebe39-362">Validate arguments to ensure that the target is allowed by the app.</span></span>

<span data-ttu-id="ebe39-363">Dans le cas contraire, un utilisateur malveillant peut forcer le navigateur à accéder à un site Contrôlé par un attaquant.</span><span class="sxs-lookup"><span data-stu-id="ebe39-363">Otherwise, a malicious user can force the browser to go to an attacker-controlled site.</span></span> <span data-ttu-id="ebe39-364">Dans ce scénario, l’attaquant tente d’utiliser une entrée utilisateur dans le cadre de l’appel de la <xref:Microsoft.AspNetCore.Components.NavigationManager.NavigateTo%2A?displayProperty=nameWithType> méthode.</span><span class="sxs-lookup"><span data-stu-id="ebe39-364">In this scenario, the attacker tricks the app into using some user input as part of the invocation of the <xref:Microsoft.AspNetCore.Components.NavigationManager.NavigateTo%2A?displayProperty=nameWithType> method.</span></span>

<span data-ttu-id="ebe39-365">Ce Conseil s’applique également lors du rendu des liens dans le cadre de l’application :</span><span class="sxs-lookup"><span data-stu-id="ebe39-365">This advice also applies when rendering links as part of the app:</span></span>

* <span data-ttu-id="ebe39-366">Si possible, utilisez des liens relatifs.</span><span class="sxs-lookup"><span data-stu-id="ebe39-366">If possible, use relative links.</span></span>
* <span data-ttu-id="ebe39-367">Vérifiez que les destinations des liens absolus sont valides avant de les inclure dans une page.</span><span class="sxs-lookup"><span data-stu-id="ebe39-367">Validate that absolute link destinations are valid before including them in a page.</span></span>

<span data-ttu-id="ebe39-368">Pour plus d’informations, consultez <xref:security/preventing-open-redirects>.</span><span class="sxs-lookup"><span data-stu-id="ebe39-368">For more information, see <xref:security/preventing-open-redirects>.</span></span>

## <a name="security-checklist"></a><span data-ttu-id="ebe39-369">Liste de contrôle de sécurité</span><span class="sxs-lookup"><span data-stu-id="ebe39-369">Security checklist</span></span>

<span data-ttu-id="ebe39-370">La liste suivante de considérations sur la sécurité n’est pas exhaustive :</span><span class="sxs-lookup"><span data-stu-id="ebe39-370">The following list of security considerations isn't comprehensive:</span></span>

* <span data-ttu-id="ebe39-371">Validez les arguments des événements.</span><span class="sxs-lookup"><span data-stu-id="ebe39-371">Validate arguments from events.</span></span>
* <span data-ttu-id="ebe39-372">Validez les entrées et les résultats des appels d’interopérabilité JS.</span><span class="sxs-lookup"><span data-stu-id="ebe39-372">Validate inputs and results from JS interop calls.</span></span>
* <span data-ttu-id="ebe39-373">Évitez d’utiliser (ou de valider au préalable) une entrée utilisateur pour les appels d’interopérabilité de .NET vers JS.</span><span class="sxs-lookup"><span data-stu-id="ebe39-373">Avoid using (or validate beforehand) user input for .NET to JS interop calls.</span></span>
* <span data-ttu-id="ebe39-374">Empêche le client d’allouer une quantité de mémoire non liée.</span><span class="sxs-lookup"><span data-stu-id="ebe39-374">Prevent the client from allocating an unbound amount of memory.</span></span>
  * <span data-ttu-id="ebe39-375">Données dans le composant.</span><span class="sxs-lookup"><span data-stu-id="ebe39-375">Data within the component.</span></span>
  * <span data-ttu-id="ebe39-376">`DotNetObject` références retournées au client.</span><span class="sxs-lookup"><span data-stu-id="ebe39-376">`DotNetObject` references returned to the client.</span></span>
* <span data-ttu-id="ebe39-377">Protégez-vous contre plusieurs distributions.</span><span class="sxs-lookup"><span data-stu-id="ebe39-377">Guard against multiple dispatches.</span></span>
* <span data-ttu-id="ebe39-378">Annule les opérations de longue durée lorsque le composant est supprimé.</span><span class="sxs-lookup"><span data-stu-id="ebe39-378">Cancel long-running operations when the component is disposed.</span></span>
* <span data-ttu-id="ebe39-379">Évitez les événements qui génèrent de grandes quantités de données.</span><span class="sxs-lookup"><span data-stu-id="ebe39-379">Avoid events that produce large amounts of data.</span></span>
* <span data-ttu-id="ebe39-380">Évitez d’utiliser les entrées d’utilisateur dans le cadre des appels à <xref:Microsoft.AspNetCore.Components.NavigationManager.NavigateTo%2A?displayProperty=nameWithType> et de valider les entrées d’utilisateur pour les URL par rapport à un ensemble d’origines autorisées en premier, si ce n’est pas inévitable.</span><span class="sxs-lookup"><span data-stu-id="ebe39-380">Avoid using user input as part of calls to <xref:Microsoft.AspNetCore.Components.NavigationManager.NavigateTo%2A?displayProperty=nameWithType> and validate user input for URLs against a set of allowed origins first if unavoidable.</span></span>
* <span data-ttu-id="ebe39-381">Ne prenez pas des décisions d’autorisation en fonction de l’état de l’interface utilisateur, mais uniquement de l’état du composant.</span><span class="sxs-lookup"><span data-stu-id="ebe39-381">Don't make authorization decisions based on the state of the UI but only from component state.</span></span>
* <span data-ttu-id="ebe39-382">Envisagez d’utiliser la [stratégie de sécurité de contenu (CSP)](https://developer.mozilla.org/docs/Web/HTTP/CSP) pour vous protéger contre les attaques XSS.</span><span class="sxs-lookup"><span data-stu-id="ebe39-382">Consider using [Content Security Policy (CSP)](https://developer.mozilla.org/docs/Web/HTTP/CSP) to protect against XSS attacks.</span></span>
* <span data-ttu-id="ebe39-383">Envisagez d’utiliser CSP et [X-Frame-options](https://developer.mozilla.org/docs/Web/HTTP/Headers/X-Frame-Options) pour vous protéger contre la prise de contrôle de clic.</span><span class="sxs-lookup"><span data-stu-id="ebe39-383">Consider using CSP and [X-Frame-Options](https://developer.mozilla.org/docs/Web/HTTP/Headers/X-Frame-Options) to protect against click-jacking.</span></span>
* <span data-ttu-id="ebe39-384">Vérifiez que les paramètres CORS sont appropriés lors de l’activation de CORS ou de la désactivation explicite de CORS pour les Blazor applications.</span><span class="sxs-lookup"><span data-stu-id="ebe39-384">Ensure CORS settings are appropriate when enabling CORS or explicitly disable CORS for Blazor apps.</span></span>
* <span data-ttu-id="ebe39-385">Testez pour vous assurer que les limites côté serveur de l' Blazor application offrent une expérience utilisateur acceptable sans niveaux de risque inacceptable.</span><span class="sxs-lookup"><span data-stu-id="ebe39-385">Test to ensure that the server-side limits for the Blazor app provide an acceptable user experience without unacceptable levels of risk.</span></span>
